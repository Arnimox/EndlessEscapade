using Terraria;
using Terraria.Graphics.Effects;
using Terraria.Graphics.Shaders;
using Terraria.ID;
using Terraria.Localization;
using Terraria.ModLoader;
using System.Reflection;
using Microsoft.Xna.Framework;
using Terraria.Utilities;
using Terraria.World.Generation;
using Terraria.GameContent.Generation;
using System;
using System.Collections.Generic;
using System.Diagnostics;
using ReLogic.Graphics;
using Terraria.UI;
using Terraria.GameContent.UI.States;
using Microsoft.Xna.Framework.Graphics;
using MonoMod.Cil;

namespace EEMod
{

    public class EESubWorlds
    {
      public void CoralReefs()
      {
          Main.maxTilesX = 400;
           Main.maxTilesY = 400;
           Main.spawnTileX = 234;
           Main.spawnTileY = 92;
           Logging.Terraria.InfoFormat("Generating World: {0}", (object)Main.ActiveWorldFileData.Name);
           _lastSeed = seed;
           _generator = new WorldGenerator(seed);
           MicroBiome.ResetAll();

           //WorldHooks.PreWorldGen();
           AddGenerationPass("Reset", delegate (GenerationProgress progress)
           {
               Liquid.ReInit();
               progress.Message = "";
               Main.cloudAlpha = 0f;
               Main.maxRaining = 0f;
               Main.raining = false;
               WorldGen.RandomizeTreeStyle();
               WorldGen.RandomizeCaveBackgrounds();
               WorldGen.RandomizeBackgrounds();
               WorldGen.RandomizeMoonState();

           });
           Main.worldID = WorldGen.genRand.Next(int.MaxValue);
           //WorldHooks.ModifyWorldGenTasks(_generator._passes, ref _generator._totalLoadWeight);
           _generator.GenerateWorld(customProgressObject);
           EEWorld.EEWorld.FillRegion(400, 400, new Vector2(0, 0), TileID.SandstoneBrick);
           EEWorld.EEWorld.Pyramid(63, 42);
           //Main.WorldFileMetadata = FileMetadata.FromCurrentSettings(FileType.World);
      }
    }
}
